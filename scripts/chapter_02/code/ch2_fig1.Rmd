---
title: "Chapter 2 - R Notebook"
author: "Salom√© Carcy"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true

---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(fig.width = 5, fig.height = 5,
                      warning=FALSE, message=FALSE,
                      root.dir = "~/Projects/phd/")
```


# IMPORT

## Import librairies
```{r import-librairies}
library(ggplot2)
library(cowplot)
library(tidyverse)
library(dplyr)
library(Seurat)
library(harmony)
library(SCpubr)
```

## Import data
```{r import-data}
seur_integrated <- readRDS("./data/seurat_objects/seurat_human_integrated_object_23_12_01.rds")
DimPlot(seur_integrated, reduction="umap_integrated", cols = cols_integrated)
```




# FIGURE 2: integrated data by tissue
Show the cells colored by tissue. Split by tissue to show overlap.
```{r fig2, fig.width=5, fig.height=5}
# order thymus first
seur_integrated@meta.data$tissue <- factor(seur_integrated@meta.data$tissue, levels=c("Thymus", "PBMC"))

do_DimPlot(
  seur_integrated,
  group.by="tissue",
  split.by="tissue",
  colors.use=cols_tissue,
  shuffle=T,
  order=NULL,
  pt.size=4,
  border.size=2,
  raster=T,
  raster.dpi = 2048
  )
ggsave("~/Projects/phd/scripts/chapter_02/figs/figs_unfinished/ch2_fig2_bis.jpeg", width=12, height=5)
```




# FIGURE 3



```{r, fig.width=10, fig.height=3}
# CD4 and CD8 expression
FeaturePlot(seur_thymus_tconv, features=c("CD4", "CD8A"), blend=T, cols = c("lightgrey", "darkred", "darkblue"), order=F)
FeaturePlot(seur_thymus_tconv, features=c("ZBTB7B", "RUNX3"), blend=T, cols = c("lightgrey", "darkred", "darkblue"), order=T)
FeaturePlot(seur_thymus_tconv, features=c("CCR9", "CCR7"), blend=T, cols = c("lightgrey", "darkred", "darkblue"), order=T)
FeaturePlot(seur_thymus_tconv, features=c("CDK1", "RAG1"), blend=T, cols = c("lightgrey", "darkred", "darkblue"), order=T)
```




# SESSION INFO
```{r}
sessionInfo()
```


